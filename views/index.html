<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
  <title>IA</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
    }

    .videoMsg {
      position: absolute;
      z-index: 10;
      top: 72%;
    }

    .spanVideoMsg{
      color: white;
      font-size: 20px;
    }
  </style>
</head>

<body id="cuerpo">

  <video muted autoplay loop preload="auto" width="100%" height="100%" style="position: fixed; overflow: hidden;  padding: 0; margin: 0; " id="reposoTrack">
    <source src="/media/video/reposo/reposo.mp4" type="video/mp4">
    <source src="/media/video/reposo/reposo.wav" type="video/wav">
    <source src="/media/video/reposo/reposo.webm" type="video/webm">
    <source src="/media/video/reposo/reposo.ogg" type="video/ogg">
    Tu navegador no soporta HTML5 video.
  </video>

  <video style="display:none;" src="/media/video/saludo/saludo.mp4" preload="auto" width="100%" height="100%" style="position: fixed; overflow: hidden;  padding: 0; margin: 0; " id="saludoTrack">
    Tu navegador no soporta HTML5 video.
  </video>

  <video style="display:none;" src="/media/video/pregunta/pregunta.mp4" preload="auto" width="100%" height="100%" style="position: fixed; overflow: hidden;  padding: 0; margin: 0; " id="preguntaTrack">
    Tu navegador no soporta HTML5 video.
  </video>

  <div class="container-fluid videoMsg d-none" id="videoMsgRespuesta">
    <div class="row justify-content-center d-flex align-items-center text-center">
      <div class="col-md-4 p-3 justify-content-center d-flex align-items-center text-center" style="background-color: black;">
        <span class="spanVideoMsg text-center">Contesta y al final menciona la palabra 'ahora'</span>
      </div>
    </div>
  </div>

  <video style="display:none;" src="/media/video/respuesta/respuesta.mp4" preload="auto" width="100%" height="100%" style="position: fixed; overflow: hidden;  padding: 0; margin: 0; " id="respuestaTrack">
    Tu navegador no soporta HTML5 video.
  </video>

  <video style="display:none;" src="/media/video/cierre/cierre.mp4" preload="auto" width="100%" height="100%" style="position: fixed; overflow: hidden;  padding: 0; margin: 0; " id="cierreTrack">
    Tu navegador no soporta HTML5 video.
  </video>

  <script src="/artyom.window.min.js"></script>
  <script src="/bootstrap/js/bootstrap.min.js"></script>

  <script>
    // SWITCH LENGUAGE
    function start(language, mode) {
      if (!language)
        language = Jarvis.getLanguage();


      let _startArtyom = function() {
        Jarvis.initialize({
          lang: language, // Start artyom with provided language
          continuous: true, // Continuous mode enabled
          listen: true, // Start recognizing
          debug: true, // Show everything in the console
          speed: 1, // talk normally
          volume: 5,
          soundex: true,
          mode: mode, // Opciones: quick, normal, slow
          // name: "jarvis"
          executionKeyword: "ahora" // say "now" at the end of a command to execute it immediately
        });

        console.log("Artyom is listening to your commands");
      };

      // stop artyom if stills active
      Jarvis.fatality();
      setTimeout(_startArtyom, 250);
    }
  </script>

  <script>
    let respuestaMode = 'normal';

    document.getElementById('saludoTrack').addEventListener('ended', () => {
      setTimeout(() => {
        playVideo('preguntaTrack');
      }, 1200);
    });

    document.getElementById('respuestaTrack').addEventListener('play', () => {
      setTimeout(() => {
        document.getElementById("videoMsgRespuesta").classList.remove("d-none");
      }, 140);
    });

    document.getElementById('respuestaTrack').addEventListener('ended', () => {
      
      document.getElementById("videoMsgRespuesta").classList.add("d-none");
      // stop artyom if stills active
      Jarvis.fatality();
      setTimeout(() => {
        start('es-ES', respuestaMode);
        // initJarvisCommands(Jarvis);
      }, 250)

      // setTimeout(() => {
      //   Jarvis.say("Contesta la pregunta y al final menciona la palabra 'ahora' para que se ejecute la orden");
      // }, 140);

      // setTimeout(() => {
      //   document.getElementById("videoMsgRespuesta").classList.remove("d-none");
      // }, 140);

      // setTimeout(() => {
      //   Jarvis.say("Para desactivar las ordenes activadas con una palabra al final menciona la palabra 'desactivar' y al final menciona la palabra 'ahora' para que se ejecute la orden");
      // }, 400);
      // setTimeout(restartJarvis, 250);
    });

    function configVideos(arrVideoElementsIds = ["reposoTrack", "saludoTrack", "preguntaTrack", "respuestaTrack", "cierreTrack"]) {
      arrVideoElementsIds.forEach(video => {
        let videoElement = document.getElementById(video);
        videoElement.style.width = screen.width;
        videoElement.style.height = screen.height;

        if (video != 'reposoTrack') {
          document.getElementById(video).addEventListener('ended', () => {
            document.getElementById(video).style.display = 'none';
            document.getElementById('reposoTrack').style.display = 'inherit';
            document.getElementById('reposoTrack').play();
          });

          document.getElementById(video).addEventListener('play', () => {
            document.getElementById('reposoTrack').style.display = 'none';
          });
        }
      });
    }

    function playVideo(videoId) {
      document.getElementById(videoId).style.display = 'inherit';
      document.getElementById(videoId).play();
    }

    configVideos();
  </script>

  <script>
    let Jarvis = new Artyom();

    // initJarvisCommands(Jarvis);
    //   /**
    //    * Note that this commands will work only in english mode .. in other language they will be not so good 
    //    * recognized.
    //    */
    Jarvis.addCommands({
      // note that if you're in spanish for example
      // the command should be instead : "Iniciar en ingles, Iniciar en alemán" etc...
      indexes: ["pasar a italiano", "pasar a alemán",
        "pasar a francés", "pasar a español",
        "pasar a portuges", "pasar a holandés",
        "pasar a polaco", "pasar a indonesio",
        "pasar a inglés"
      ],
      action: function(i) {
        switch (i) {
          case 0:
            stop();
            start("it-IT");
            break;
          case 1:
            start("de-IT");
            break;
          case 2:
            start("fr-FR");
            break;
          case 3:
            start("es-ES");
            break;
          case 4:
            start("pt-PT");
            break;
          case 5:
            start("nl-NL");
            break;
          case 6:
            start("pl-PL");
            break;
          case 7:
            start("id-ID");
            break;
          case 8:
            start("en-GB");
            break;
        }
      }
    });

    // ERROR DE QUE SE ESCUCHA ASI MISMO VALIDAR LA PALABRA Y CAMBIARLA POR UN SINONIMO CON UN DICCIONARIO en JS
    Jarvis.on(['reposo', 'saludos', 'La monalisa', 'a bueno', 'me alegra', 'sí Joan sabe', 'desactivar']).then(function(i) {
      switch (i) {
        case 0:
          playVideo('reposoTrack');
          Jarvis.say("Estoy sin hacer nada");
          break;
        case 1:
          playVideo('saludoTrack');
          break;
        case 2:
          playVideo('respuestaTrack');
          break;
        case 3:
        case 4:
        case 5:
          playVideo('cierreTrack');
          break;
        case 6:
          start('es-ES', 'quick');
          if (respuestaMode) respuestaMode = 'quick'
          break;
      }
    });

    // on command recognition end
    Jarvis.when("COMMAND_RECOGNITION_END", function(status) {
      if (status.code == "continuous_mode_enabled") {
        console.info("Command reconition finalized, restarting because the continuous mode is enabled");
      }
    });

    // Catch errors
    Jarvis.when("ERROR", function(data) {
      console.error(data);
    });

    start("es-ES", 'quick');
    // or
    // start("en-GB");
    // or 
    // start("en-US");
  </script>

</body>

</html>
<!-- HACER CLIC AL CARGAR LA PÁGINA POR PRIMERA VEZ -->